# Environment configuration for TimeTiles
# Copy this to .env.local and adjust values as needed

# Database connection (REQUIRED)
# This is used as the base for all database connections
# Test databases will be derived from this (e.g., timetiles_test, timetiles_test_1, etc.)
DATABASE_URL=postgresql://timetiles_user:timetiles_password@localhost:5432/timetiles

# Payload CMS configuration
PAYLOAD_SECRET=your-secret-key-here
NEXT_PUBLIC_PAYLOAD_URL=http://localhost:3000
PAYLOAD_PREVIEW_SECRET=your-preview-secret-here

# Environment
NODE_ENV=development

# Geocoding Services (for Event Import System)
# Google Maps API key for primary geocoding
GEOCODING_GOOGLE_MAPS_API_KEY=your_GEOCODING_GOOGLE_MAPS_API_KEY_here

# File Upload Configuration
# Maximum file sizes in bytes
MAX_FILE_SIZE_AUTHENTICATED=104857600  # 100MB for authenticated users
MAX_FILE_SIZE_UNAUTHENTICATED=10485760 # 10MB for unauthenticated users

# Upload Directory Configuration
# Configure where uploaded files are stored (relative to apps/web or absolute paths)
UPLOAD_DIR_MEDIA=media                 # Directory for media uploads (images)
UPLOAD_DIR_IMPORT_FILES=import-files   # Directory for import file uploads
UPLOAD_TEMP_DIR=./tmp                  # Temporary directory for file processing

# Rate Limiting Configuration (for unauthenticated users)
RATE_LIMIT_FILE_UPLOAD=5      # 5 uploads per hour
RATE_LIMIT_PROGRESS_CHECK=100 # 100 progress checks per hour
RATE_LIMIT_API_GENERAL=50     # 50 general API requests per hour
RATE_LIMIT_WINDOW_MS=3600000  # 1 hour window in milliseconds

# Job Queue Configuration
BATCH_SIZE=100          # Number of rows processed per batch
GEOCODING_BATCH_SIZE=10 # Number of addresses geocoded per batch
GEOCODING_DELAY_MS=1000 # Delay between geocoding batches (ms)

# Cache Configuration
GEOCODING_CACHE_CLEANUP_DAYS=90 # Days before cleaning up unused cache entries
GEOCODING_CACHE_MIN_HITS=3      # Minimum hits required to keep cache entry

# HTTP Cache Configuration
CACHE_BACKEND=filesystem        # Cache backend: memory or filesystem
CACHE_DEFAULT_TTL=3600          # Default cache TTL in seconds (1 hour)
CACHE_MAX_SIZE_MB=500           # Maximum cache size in MB
CACHE_MAX_ENTRIES=1000          # Maximum number of cache entries (memory backend)
CACHE_DIR=.cache                # Base cache directory (filesystem backend)
CACHE_CLEANUP_INTERVAL_MS=3600000 # Cache cleanup interval (1 hour)
HTTP_CACHE_DEFAULT_TTL=3600     # Default TTL for HTTP cache entries
HTTP_CACHE_DIR=/tmp/http-cache  # Directory for HTTP cache storage
HTTP_CACHE_MAX_SIZE=104857600   # Maximum size of HTTP cache in bytes (100MB)
HTTP_CACHE_TTL=3600             # Default TTL for HTTP cache entries in seconds

# Note: Test databases are automatically derived from DATABASE_URL
# - E2E tests use: ${database}_test (e.g., timetiles_test)
# - Unit/Integration tests use: ${database}_test_${worker_id} (e.g., timetiles_test_1, timetiles_test_2)

# Optional: Redis for distributed rate limiting (future enhancement)
# REDIS_URL=redis://localhost:6379

# Optional: Webhook notifications (future enhancement)
# WEBHOOK_SECRET=your-webhook-secret
# WEBHOOK_URL=https://your-app.com/webhooks/import-complete
