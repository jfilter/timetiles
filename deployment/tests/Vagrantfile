# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config|
  config.vm.box = "bento/ubuntu-24.04"
  config.vm.hostname = "timetiles-test"

  config.vm.provider "virtualbox" do |vb|
    vb.memory = "4096"
    vb.cpus = 2
    vb.name = "timetiles-test"
  end

  # Sync the project directory
  config.vm.synced_folder "../..", "/home/vagrant/timetiles", type: "rsync",
    rsync__exclude: [".git/", "node_modules/", ".next/", "dist/", ".turbo/", "coverage/", ".worktrees/"]

  # Provision: install Docker and BATS
  config.vm.provision "shell", inline: <<-SHELL
    apt-get update -qq
    apt-get install -y -qq docker.io docker-compose-v2 bats
    usermod -aG docker vagrant
    systemctl enable docker
    systemctl start docker
  SHELL
end
